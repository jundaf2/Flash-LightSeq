Script started on 2022-10-12 22:23:22+0800
(base) ]0;poweruser@s-113-1-1: ~/junda.feng/ixinfer/TransformerInfer/build[01;32mpoweruser@s-113-1-1[00m:[01;34m~/junda.feng/ixinfer/TransformerInfer/build[00m$ exit./TransfomrerInfer ../model_weights/transformer.pb 0 1build/linux/app/bin/Debug/x86_64/vulkan_samples sample ray_queries[14PTransfomrerInfer ../model_weights/transformer.pb 0 1[C[1P 11 1
Parsing protobuf: ../model_weights/transformer.pb
Finish loading src_emb_wei from host to device
Finish loading trg_emb_wei from host to device
Finish loading enc_wei from host to device
Finish loading dec_wei from host to device
Finish loading all weight from host to device
***model config***
encoder layers: 8
decoder layers: 4
hidden size: 512
inner size: 2048
head number: 8
dim per head: 64
src vocab size: 5003
trg vocab size: 5003
is_post_ln: 0
no_scale_embedding: 0
use_gelu: 0
start_id: 5001
end_id: 5002
padding_id: 5003
multilg_type: 0

***generator config***
beam size: 1
max step: 64
extra decode length(max decode length - src input length): 0
length penalty: 0.6
diverse lambda: 0
sampling method: topk
topk: 32
topp: 0.75
Allocated 49MB GPU buffer for transformer
encoder buffer init start
encoder buffer init succeed
decoder buffer init start
decoder buffer init succeed
infer preprocessing finished
batch_size-1 batch_seq_len-6
batch_token_ids: 1, 2, 3, 4, 5, 6, 
launch encoder embedding kernel
emb out: token-0
emb out: -0.0150833, 0.0685425, -0.106201, 0.00239563, 0.398682, -0.286865, 0.314941, -0.265869, 0.153198, -0.279297, 
emb out: token-1
emb out: 0.320801, 0.648438, 0.632324, 1.08594, 0.52002, 0.284668, -0.324219, 0.87793, 0.930176, 1.09375, 
emb out: token-2
emb out: 0.386719, 1.30664, 1.16504, 0.727051, 0.981934, 0.657227, 1.63867, 1.0459, 0.832031, -0.708008, 
emb out: token-3
emb out: 0.324707, 0.287109, 0.512695, 0.138916, 0.640625, 0.786133, -0.0375977, 0.714355, 0.888184, 2.16797, 
emb out: token-4
emb out: -0.778809, -0.714355, -0.896484, -0.582031, -0.527832, -0.30249, 0.157349, -0.200928, 0.00512695, 1.28613, 
emb out: token-5
emb out: -0.854004, -0.850098, -1.14746, -1.61328, -0.500977, -1.0791, -0.970703, -1.11133, -1.09766, -0.216187, 
token embedding weight: 0.465576, 0.972656, -0.150146, -0.438477, -0.153198, -0.385986, -0.687012, 1.60547, 0.226685, 0.812012, 
position embedding weight: 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
launch flash-self-attention layer 0
fused Flash-Attention: 6048 microseconds
encoder attention output: -0.0737915, 0.101746, -0.110168, -0.00226212, 0.432861, -0.274902, 0.348389, -0.222656, 0.223633, -0.297363, -0.382324, 0.644043, 0.25708, 1.37695, -0.317383, 0.502441, -2.42188, 0.183716, -1.87891, -0.630859, -0.503418, -0.67041, -0.639648, 0.803711, 1.57812, -2.25391, 1.97852, 0.0626221, -0.375977, 1.64941, -2.14844, 1.99609, -1.4209, -1.00879, 0.389893, 1.32812, 0.668457, -4.48828, 0.0158691, 1.56348, -3.41406, -2.4082, -4.125, 0.47583, -1.50195, -3.70898, -4.63281, -8.16406, -4.50391, -2.97266, -5.00781, -1.3584, 4.70312, 4.49219, -3.68359, 0.902832, 0.476318, -4.55078, -1.29785, 1.71387, -1.32812, 4.30469, -1.34668, -2.22656, 
launch FFN layer 0
launch flash-self-attention layer 1
fused Flash-Attention: 1480 microseconds
encoder attention output: -8.05469, -11.7578, -6.67188, -5.97656, -7.5625, -6.08984, -2.51562, -5.01953, -7.25781, -3.22852, -1.31152, -0.57959, -2.35156, -3.11328, -1.45508, 0.0220947, -7.40625, -0.0114746, -7.5625, -2.42773, -4.30078, 0.306152, -4.39453, -0.538574, 2.70898, -4.73047, 6.70703, 0.692383, -2.77148, 3.11328, -6.05469, 3.53516, -3.82812, -2.73047, -0.705078, 1.85254, 3.14844, -10.0078, -1.16992, 0.0759888, -7.46094, -4.96875, -8.10938, -1.11035, -4.43359, -5.375, -7.47266, -14.0469, -8.46875, -6.03125, -7.40625, -2.39258, 5.41016, 5.29688, -8.27344, 1.93262, 1.11719, -9.09375, -4.00391, 3.25195, -2.09766, 4.77734, -0.584961, -4.25781, 
launch FFN layer 1
launch flash-self-attention layer 2
fused Flash-Attention: 1475 microseconds
encoder attention output: -8.51562, -14.3203, -6.48828, -2.31836, -9.42188, -6.13672, -0.510742, -5.92578, -11.1719, -6.22266, 0.275635, 0.598633, -2.28125, -3.3125, -1.47363, 1.38867, -12.8125, 1.06445, -11.7422, -2.40234, -4.89062, 2.40039, -4.49219, 3.18555, 3.5625, -2.96289, 12.2344, 1.42188, -3.28125, 3.81641, -6.37891, 6.42969, -3.9668, -5.31641, -2.08984, 5.08594, 7.89453, -12.4531, -1.5, -0.848633, -10.5156, -4.61328, -9.74219, 0.975098, -6.4375, -8.07812, -12.0781, -15.625, -11.2344, -7.42188, -9.375, -1.4209, 7.52344, 8.04688, -10.4453, 4.34766, -3.48828, -13.4375, -4.67969, 8.92188, -2.03711, 6.33984, 0.980957, -5.78516, 
launch FFN layer 2
launch flash-self-attention layer 3
fused Flash-Attention: 1478 microseconds
encoder attention output: -5.10156, -20.5781, -7.16016, -0.743164, -9.5, -4.39844, 4.19141, -8.02344, -12.5156, -7.75781, -2.56641, 0.603516, -3.39844, -4.14453, -1.24121, 2.63867, -15.5078, 0.560547, -15.1016, -5.21484, -5.17578, 2.27344, -8.82031, 5.39062, 9.24219, -4.85547, 13.5078, 4.53906, -2.74023, 4.16016, -5.875, 7.76953, -5.61328, -5.51172, -7.05859, 5.35547, 11.0078, -14.5, -5.65234, -1.56934, -9.00781, -5.89062, -15.6406, -0.276855, -8.80469, -9.4375, -14.6562, -21.1094, -17.9531, -5.24609, -10.5781, -0.938965, 9.25, 12.5078, -10.5469, 0.0330811, -6.42188, -18.4375, -6.1875, 12.1953, -4.00391, 12.2734, 2.70508, -8.21875, 
launch FFN layer 3
launch flash-self-attention layer 4
fused Flash-Attention: 1475 microseconds
encoder attention output: -4.12109, -23, -6.15234, -0.63916, -9.71094, -4.34375, 7.07031, -11.3125, -16.4219, -9.90625, -1.68066, 0.65332, -1.23926, -2.16016, 0.195801, 2.5293, -19.4531, 0.0385742, -17.5156, -9.71875, -5.37109, 6.14844, -8, 8.32812, 11.3438, -3.03516, 18.4375, 4.85547, -1.69238, 1.7334, -9.30469, 8.10938, -4.6875, -9.57812, -12.4766, 8.50781, 13.5391, -18.4844, -4.32422, 0.156616, -9.53125, -3.80664, -15.9141, 4.47266, -11.1094, -11.2891, -12.9844, -24, -22.0312, -5.68359, -8.1875, -1.88281, 9.8125, 14.2734, -10.375, 0.847656, -11.6016, -18.6875, -1.89746, 16.5781, -2.49219, 15.5312, 4.3125, -9.57812, 
launch FFN layer 4
launch flash-self-attention layer 5
fused Flash-Attention: 1478 microseconds
encoder attention output: -0.429443, -27.6406, 0.703125, -0.0924072, -10.4688, -3.33203, 9.51562, -15.625, -16.7812, -8.99219, -0.207031, 0.999023, -1.0625, -3.44141, 0.221802, -0.679199, -25.375, 2.47656, -19.125, -14.4609, -4.23828, 15.0703, -10.4062, 8.04688, 14.1406, -1.43359, 20.3125, 2.60352, -3.72656, 7.17969, -14.2188, 12.9375, -3.84766, -12.4766, -18.8594, 10.0469, 11.9844, -23.3906, -3.34961, 0.695801, -6.67578, -2.39062, -20.375, 5.98828, -9.40625, -17.0156, -20.0156, -30.1094, -26.8438, -12.9297, -14.5469, -2.30078, 12.1641, 17.6875, -13.0391, -3.67773, -22.7344, -21.0938, 1.24121, 17.3438, 1.04883, 22.125, 2.24414, -7.92578, 
launch FFN layer 5
launch flash-self-attention layer 6
fused Flash-Attention: 1481 microseconds
encoder attention output: -7.72266, -31.2656, 0.757812, 0.0911255, -12.25, 0.560059, 15.8125, -18.9219, -30.7031, -10.7266, 4.96484, 1.3584, -3.48633, -1.47559, 0.782227, -5.19922, -29.5625, -0.0634766, -18.5781, -18.1719, -5.79688, 14.1797, -13.5859, 8.96875, 20.7812, -6.98438, 20.2969, 3.22852, -4.69531, 6.91797, -11.8516, 13.5234, -2.73633, -12.5391, -23.9531, 6.59375, 7.73828, -25.8125, -2.56445, 0.412598, -13.9453, -5.08594, -24.3125, 6.24219, -6.90234, -17.2031, -25.1094, -28.1094, -28.2188, -17.0781, -13.1641, -5.26953, 11.5547, 21.3438, -13.0469, -1.64746, -25.2344, -21.2812, 3.75977, 19.5156, -4.42969, 21.0625, 2.54688, -7.41016, 
launch FFN layer 6
launch flash-self-attention layer 7
fused Flash-Attention: 1478 microseconds
encoder attention output: -11.5391, -33.2812, 4.28906, 2.33789, -14.1484, 1.68359, 29.3594, -28.1562, -46.5312, -15.5312, 6.58594, 4.625, 7.86328, -10.1797, -1.00391, -10.5781, -32.0312, 1.95508, -22.0156, -20.8281, -6.32031, 16, -12.3828, 11.2656, 25.1562, -7.67969, 24.6562, 6.77734, -10.7969, 1.30664, -11.1484, 13.1172, -12, -9.61719, -33.375, 14.8203, 1.67969, -30.4844, -5.51172, 0.663086, -22.4219, -2.60352, -43.4688, 14.8594, -8.35938, -20, -32.2188, -37.0625, -36.625, -24.0938, -12.8828, -7.22656, 18, 16.6875, -10.75, 1.83496, -33.375, -35.5625, 15.6953, 20.25, -4.55078, 19.3281, 8.46094, -1.58203, 
launch FFN layer 7
encoder output: token-0
encoder_output: -0.179932, -0.414795, 0.106262, -0.0604248, -0.0635986, 0.0402222, 0.614258, -0.385254, -0.895996, -0.194824, 0.151489, 0.145264, 0.189453, -0.125977, 0.0982666, -0.311523, -0.444336, 0.101746, -0.537109, -0.447998, -0.186523, 0.366943, -0.158325, 0.121948, 0.549805, -0.0888672, 0.491699, 0.360107, -0.105408, -0.0508423, -0.151123, 0.252197, -0.169556, -0.341064, -0.669922, 0.223145, -0.109741, -0.543457, -0.0131607, 0.148193, -0.636719, -0.17041, -0.662598, 0.168701, -0.086792, -0.283447, -0.586426, -0.70166, -0.476318, -0.453857, -0.185181, -0.355225, 0.374512, 0.269043, -0.416992, 0.124939, -0.449219, -0.365967, 0.173706, 0.428223, -0.0351257, 0.276855, 0.0518799, 0.133179, 
encoder output: token-1
encoder_output: -0.139404, -0.0594482, 0.119934, 0.0305176, -0.0464172, 0.0758057, -0.144043, 0.0883789, 0.536621, 0.214722, -0.712891, 0.143921, -0.0733643, -0.286133, 0.288574, 0.0686035, -0.14856, -0.345703, 0.248413, -0.467041, 0.418457, 0.617188, 0.383789, 0.0121841, 0.156616, -0.311523, -0.240601, -0.364258, -0.229858, -0.0403442, -0.0527344, -0.147339, 0.186279, -0.640625, -0.219849, -0.257812, -0.610352, 0.387695, -0.306152, 0.186157, -0.0181122, -0.226196, -0.453613, 0.349121, 0.370117, -0.335693, -0.61377, -0.199951, -0.658203, -0.013237, 0.0108795, 0.562988, 0.430664, -0.00745392, -0.0715332, 0.620605, -0.651367, -0.324951, 0.184082, 0.0458679, 0.0808105, 0.273193, -0.284668, 0.186279, 
encoder output: token-2
encoder_output: 0.44751, 0.401611, 0.275879, 0.244141, 0.30957, -0.00964355, 0.440186, -0.147095, -0.378906, -0.528809, 0.286621, -0.242676, 0.273438, -0.23645, -0.0911255, 0.0496826, 0.349121, -0.15564, 0.432861, -0.104126, 0.414307, 0.44458, -0.338623, 0.323975, 0.0294189, 0.0888062, 0.89502, 0.13147, 1.02051, 0.0132065, -0.191895, -0.0127182, 0.0648193, 0.0614319, -0.614746, -0.261719, -0.38916, 0.159912, -0.297852, 0.390625, -0.459229, 0.515137, 0.0437012, -0.38623, 0.0881348, -0.0853271, -0.411377, -0.227539, -0.845215, -0.71875, -0.353271, 0.50293, 0.70752, 0.292236, -0.155762, 0.132446, 0.799805, -1.25879, 0.243652, -0.230347, 0.142212, 0.683105, -0.443604, 0.278076, 
encoder output: token-3
encoder_output: -0.11554, 0.156738, 0.235962, 0.32251, 0.090271, 0.391602, 0.128418, 0.53125, -0.215332, 1.21387, 0.0172882, 0.0800171, -0.115662, -0.412598, 0.462402, -0.139526, 0.519531, 0.265869, 0.164673, 0.00603104, 1.02637, 0.402588, -0.333984, 0.357178, 0.37085, 0.32373, -0.0287323, -0.356445, 0.48291, 0.0966187, 0.4104, -0.105042, 0.0280304, 0.134155, -0.409424, -0.184937, -0.483154, 0.0804443, -0.289062, 0.400391, 0.424072, -0.47998, -0.194092, -0.13501, -0.451172, -0.75293, -0.294189, -0.320068, -0.0849609, -0.351318, 0.175171, -0.558105, 0.399658, 0.10144, -0.0280457, -0.249878, -0.991699, -0.112122, 0.899902, 0.401855, 0.182007, 0.696289, -0.237427, 0.127319, 
encoder output: token-4
encoder_output: -0.254883, 0.0809937, 0.19458, -0.0331116, -0.606445, 0.234009, -0.181885, 0.0910034, -0.440186, 0.643555, 0.0141296, -0.204712, -0.0752563, -0.328613, -0.0609436, 0.231812, -0.053833, 0.677734, 0.220337, 0.184692, 0.124878, 0.403564, -0.690918, -0.239258, 0.243042, -0.0291443, 0.282959, 0.31543, -0.360352, -0.0267944, 0.676758, 0.244629, 0.446289, -0.0185699, -0.740234, -0.067627, 0.561523, 0.335938, -0.0684204, -0.152344, 0.270264, -0.220703, -0.475098, -0.370117, 0.0458069, -0.001688, -0.00325775, 0.00558472, -0.291016, -0.140137, 0.185059, -0.708496, 0.25708, 0.205933, -0.258545, -0.120361, 0.0654297, -0.665527, 0.673828, 0.0532837, -0.226685, 0.307373, -0.189087, 0.312012, 
encoder output: token-5
encoder_output: 0.151611, -0.159058, 0.0275269, 0.168091, -0.409668, -0.302734, -0.0382996, 0.0709839, -0.189941, 0.0336914, -0.384277, 0.0446167, -0.297363, -0.174438, 0.370361, -0.45752, -0.314697, 0.178833, 0.200806, -0.0738525, 0.356201, 0.0928345, -0.0836182, -0.243408, 0.106201, 0.540039, -0.341309, -0.0744629, -0.0585022, 0.0924072, 0.481201, 0.438721, 0.34668, -0.504395, -0.625977, 0.328125, -0.289795, -0.311768, -0.406738, 0.479248, -0.0619202, 0.0109253, -0.197144, 0.679688, 0.419922, 0.0826416, 0.328125, 0.538086, 0.15625, -0.796387, -0.103699, 0.193481, 0.246826, 0.299561, -0.114014, 0.42749, -0.310059, -0.439941, 0.283936, -0.293457, 0.143921, 0.385986, -0.421143, 0.598145, 
_p_d_encoder_output(head):: -0.179932, -0.414795, 0.106262, -0.0604248, -0.0635986, 
_p_d_encoder_output(tail): 0.292725, -0.39502, -0.393311, 0.184326, 0.0601196, 
encoder project(head):: -0.306152, -0.644043, -0.0342407, -0.16687, 0.076416, -0.156494, -0.16272, 0.015976, -0.0116425, -0.417969, 
encoder out(head):: 1.38867, 1.84082, -0.294189, 1.33984, -1.50293, 
encoder out(tail):: -0.546387, -2.82422, -3.30664, 3.15234, 0.10553, 
*** run step 0 ***
decoder emb: batch-0, beam-0
emb: 0.00182629, 0.103638, 0.390869, 0.159424, -18.0938, 0.353516, 0.663086, -0.0861206, 0.976074, -0.0918579, 
self attn ln(head): : -0.0372925, -0.0215607, -0.017395, -0.00482941, 0.0398865, 
self attn ln(tail): : 0.0351868, -0.0314636, 0.0230103, -0.0551453, -0.0448914, 
self qkv(head): : -0.138428, -0.119873, -0.473633, 0.56543, 0.268311, 
self qkv(tail): : 0.0426941, -0.0317688, 0.0110168, 0.118896, -0.125732, 
self attn q(head): : -0.00683594, -0.185303, -0.708984, 0.485352, 0.191895, 
self attn q(tail): : -0.06427, 0.10907, 0.670898, 0.236694, 0.0507202, 
self attn k(head): : 1.7373, 0.192871, -0.489258, -0.595703, -2.20312, 
self attn k(tail): : -1.9668, -2.04492, -7.95312, 0.553711, -6.63672, 
self attn v(head): : 0.118713, -0.200195, 0.129395, -0.0739136, 0.0744629, 
self attn v(tail): : -0.0343933, -0.0805664, 0.107422, 0.104309, 0.0698242, 
self attn corr(head): : 1, 1, 1, 1, 1, 
self attn corr(tail): : 1, 1, 1, 1, 1, 
self attn before ffn(head): : 0.118713, -0.200195, 0.129395, -0.0739136, 0.0744629, 
self attn before ffn(tail): : -0.0343933, -0.0805664, 0.107422, 0.104309, 0.0698242, 
self attn out(head): : -0.234131, -0.0283508, 0.0227051, 
self attn out(tail): : -1.08594, 1.37305, 0.743164, 
encdec attn ln(head): : -0.0162201, -0.00386429, -0.0501709, -0.00765228, -0.566895, 
encdec attn ln(tail): : 0.0761719, -0.0423279, 0.025238, -0.0996704, -0.0570374, 
encdec attn ffn out(head): : -0.294434, 0.480713, -0.630859, 
encdec attn ffn out(tail): : -2.73242, 3.63477, 8.02344, 
ffn ln(head): : -0.0982056, -0.149292, -0.373047, -0.219482, 1.22754, 
ffn ln(tail): : 0.147461, -0.260742, 0.298096, -0.101196, -0.0588074, 
ffn ln(head): : -0.627441, 1.31641, -0.0620117, 0.338623, -188.5, 
ffn ln(tail): : -5.52344, -2.23047, -3.24219, 2.82812, 9, 
self attn ln(head): : -0.00164413, 0.0138321, -0.0438232, -0.00355721, -0.0182343, 
self attn ln(tail): : -0.0223999, -0.0585938, -0.00358582, -0.0247498, 0.0163422, 
self qkv(head): : -0.421875, 0.383057, 0.128418, 0.312012, -0.496338, 
self qkv(tail): : 0.28418, -0.837891, -0.555664, -0.0774536, 0.266113, 
self attn q(head): : -0.354736, 0.348145, 0.279785, 0.380371, -0.39502, 
self attn q(tail): : 0.725586, -0.421143, -0.57373, 0.908203, 0.0871582, 
self attn k(head): : -0.365479, 0.769531, 1.06055, -1.45312, 1.67188, 
self attn k(tail): : 0.867188, -0.580078, -1.56641, -0.713867, 0.349121, 
self attn v(head): : 0.569824, 0.105957, 0.23999, -0.0533447, -0.47998, 
self attn v(tail): : 0.385254, -1.2793, -0.63916, -0.158325, 0.135376, 
self attn corr(head): : 1, 1, 1, 1, 1, 
self attn corr(tail): : 1, 1, 1, 1, 1, 
self attn before ffn(head): : 0.569824, 0.105957, 0.23999, -0.0533447, -0.47998, 
self attn before ffn(tail): : 0.385254, -1.2793, -0.63916, -0.158325, 0.135376, 
self attn out(head): : 2.05664, 2.29883, 2.10156, 
self attn out(tail): : -0.826172, 1.81641, 8.69531, 
encdec attn ln(head): : -0.0442505, 0.0543823, -0.0410461, 0.0532837, -0.0764771, 
encdec attn ln(tail): : -0.0325623, 0.00974274, 0.0276794, -0.0363464, 0.0328369, 
encdec attn ffn out(head): : 0.929688, 2.69922, 4.40625, 
encdec attn ffn out(tail): : -1.43359, 1.70898, 14.75, 
ffn ln(head): : -0.0643311, -0.0541992, -0.401123, -0.165894, 2.20312, 
ffn ln(tail): : -0.0194397, 0.363281, 0.152832, 0.148926, 0.226196, 
ffn ln(head): : -2.69531, 3.63477, 4.97266, -1.56738, -368, 
ffn ln(tail): : -7.06641, -12.0859, -2.0625, 1.21973, 17.0625, 
self attn ln(head): : -0.0651855, 0.033844, 0.0244598, -0.024231, -0.0690918, 
self attn ln(tail): : -0.0829468, -0.156494, 0.0192413, -0.00774384, 0.0984497, 
self qkv(head): : -0.35376, 0.293213, 0.360107, 0.153687, 0.101746, 
self qkv(tail): : 0.057373, -0.51123, 0.0606079, 0.229126, 0.0464783, 
self attn q(head): : -0.405029, 0.0611572, 0.26709, 0.380371, -0.0994263, 
self attn q(tail): : -0.447754, 0.833496, -0.165405, 0.570801, -0.503418, 
self attn k(head): : 1.64062, 3.18555, 1.13281, 1.0625, 3.62109, 
self attn k(tail): : -0.776367, -0.631836, -1.58105, -5.71875, -0.00195312, 
self attn v(head): : 0.0731201, -0.244995, 0.515625, -0.745117, -0.0917969, 
self attn v(tail): : 0.112366, -0.875, 0.140625, 0.609863, -0.126099, 
self attn corr(head): : 1, 1, 1, 1, 1, 
self attn corr(tail): : 1, 1, 1, 1, 1, 
self attn before ffn(head): : 0.0731201, -0.244995, 0.515625, -0.745117, -0.0917969, 
self attn before ffn(tail): : 0.112366, -0.875, 0.140625, 0.609863, -0.126099, 
self attn out(head): : -5.96875, 4.64062, 9.10938, 
self attn out(tail): : 0.46875, 2.76172, 14.4062, 
encdec attn ln(head): : -0.0451355, 0.0390015, 0.0130157, -0.00224113, -0.145386, 
encdec attn ln(tail): : -0.0668335, -0.0651245, 0.00684738, -0.02388, 0.038147, 
encdec attn ffn out(head): : -9.19531, -4.89062, -2.07031, 
encdec attn ffn out(tail): : -17.5781, 2.84766, 8.32031, 
ffn ln(head): : -0.316895, -0.39502, -0.37085, 0.0591125, 0.654297, 
ffn ln(tail): : -0.138794, -0.0751953, -0.201782, 0.283936, 0.149536, 
ffn ln(head): : -7.02344, -4.93359, 5.58203, 3.95898, -579, 
ffn ln(tail): : -16.6562, -8.39062, -20.0312, -1.07617, 22.1875, 
self attn ln(head): : -0.163208, -0.0982666, 0.0635376, 0.0550842, 0.232422, 
self attn ln(tail): : -0.172119, -0.114929, -0.113708, -0.0425415, 0.108521, 
self qkv(head): : 0.222168, -1.44043, 0.0161896, 0.95166, 0.24292, 
self qkv(tail): : 0.865234, 0.558105, -0.856445, -0.0453796, -0.692871, 
self attn q(head): : 0.331055, -1.44238, 0.352051, 0.958496, -0.0703125, 
self attn q(tail): : 0.0173035, -1, 0.674316, 0.000732422, 0.0474243, 
self attn k(head): : 2.2793, -9.30469, 28.1094, 12.1641, -23.8281, 
self attn k(tail): : -2.05469, 0.199463, -0.103516, 0.124451, -0.190186, 
self attn v(head): : 0.332031, -0.151367, -0.889648, 0.794434, 0.67041, 
self attn v(tail): : 0.891113, 0.551758, -0.935547, 0.298828, -0.694824, 
self attn corr(head): : 1, 1, 1, 1, 1, 
self attn corr(tail): : 1, 1, 1, 1, 1, 
self attn before ffn(head): : 0.332031, -0.151367, -0.889648, 0.794434, 0.67041, 
self attn before ffn(tail): : 0.891113, 0.551758, -0.935547, 0.298828, -0.694824, 
self attn out(head): : -7.22656, -0.845703, 8.07031, 
self attn out(tail): : -17.9375, 5.50781, 25.8906, 
encdec attn ln(head): : -0.0380859, 0.0112534, 0.0197144, 0.0488281, 0.0106659, 
encdec attn ln(tail): : -0.115051, -0.0736694, -0.0546265, -0.0157166, 0.0569763, 
encdec attn ffn out(head): : -5.01172, 1.76855, 16.2656, 
encdec attn ffn out(tail): : -17.4062, 10.9844, 17.4062, 
ffn ln(head): : -0.167603, -0.164917, -0.0406189, 0.145996, -5.3125, 
ffn ln(tail): : 0.173828, -0.027832, -0.259766, 0.0946045, 0.500488, 
ffn ln(head): : 2.58203, 6.70703, 11.7031, 7.64844, -751, 
ffn ln(tail): : -4.70312, -19.4688, -15.5391, 6.09375, 17.2969, 
decoder output: batch-0, beam-0
hidden: 0.0360718, 0.253418, 0.160034, 0.449463, 4.60938, 0.17749, -1.01367, -0.163818, -0.190552, -0.184814, 
logits: -31.2188, -32.6562, -32.125, -30.125, -33.25, -31.3438, -32.7812, -31.2031, -31.2031, -37.375, 
ker_topk_sample_launcher with _cur_step=0  _max_step=64  _max_thread_per_block=256
### in ker_topk_sample_launcher 
### out ker_topk_sample_launcher 
unfinished flag: 1, 
Batch token ids: : 5001, 4, 
*** run step 1 ***
decoder emb: batch-0, beam-0
emb: 0.345947, 1.04492, 1.38867, 0.472412, -21.8438, 1.26562, 2.14844, 0.529297, 2.82227, 0.90332, 
self attn ln(head): : 0.0796509, 0.281006, 0.259277, 0.102051, -0.0756226, 
self attn ln(tail): : 0.171875, -0.323975, 0.160889, 0.161865, 0.0202789, 
self qkv(head): : 1.86328, 1.81738, -0.528809, 0.241333, -2.4375, 
self qkv(tail): : 1.08203, -0.0562439, 0.26001, -0.310059, 0.468262, 
self attn q(head): : 1.99512, 1.75195, -0.76416, 0.161377, -2.51367, 
self attn q(tail): : 2, 0.38623, 0.87793, -1.19336, -1.81055, 
self attn k(head): : -0.866211, 1.73047, 1.58984, -0.40625, 0.185547, 
self attn k(tail): : -1.78711, -4.45312, -5.46094, -2.38672, -5.89453, 
self attn v(head): : 0.30835, 1.75, 0.129272, -0.341064, -0.59668, 
self attn v(tail): : 1.00488, -0.105042, 0.356445, -0.324707, 0.664062, 
self attn corr(head): : 0.966797, 0.0331421, 0.973633, 0.0263062, 0.964844, 
self attn corr(tail): : 0.0375977, 0.999023, 0.0010004, 0.998047, 0.00218201, 
self attn before ffn(head): : 0.125, -0.135498, 0.129395, -0.0827637, 0.0522156, 
self attn before ffn(tail): : -0.032135, -0.0806274, 0.107971, 0.103394, 0.071167, 
self attn out(head): : 0.157837, 0.941406, 1.06934, 
self attn out(tail): : 1.31641, 4.72656, 1.53906, 
encdec attn ln(head): : 0.00869751, 0.0916748, 0.0361938, 0.0216522, -0.547852, 
encdec attn ln(tail): : 0.175415, -0.235229, 0.0903931, 0.0586853, -0.00850677, 
encdec attn ffn out(head): : -0.0926514, 1.28906, 1.12793, 
encdec attn ffn out(tail): : 0.781738, 7.57812, 11.2422, 
ffn ln(head): : -0.0603027, 0.115723, -0.129272, -0.319824, 0.762695, 
ffn ln(tail): : 0.197144, -0.594727, 0.404541, 0.154053, 0.356201, 
ffn ln(head): : -2.97852, 0.484375, -1.83691, -1.81152, -107.938, 
ffn ln(tail): : -2.60156, -6.03906, 3.46875, 11.3281, 11.4766, 
self attn ln(head): : -0.141479, 0.0224457, -0.131104, -0.0891724, -0.460205, 
self attn ln(tail): : -0.0325012, -0.185303, 0.0991211, 0.218384, 0.215454, 
self qkv(head): : -1.46582, 0.0931396, 1.5918, 1.12793, 0.39502, 
self qkv(tail): : -0.949219, 0.265381, -0.0154648, -0.889648, -0.70459, 
self attn q(head): : -1.39844, 0.0582886, 1.74316, 1.19629, 0.496338, 
self attn q(tail): : -0.589355, -2.48828, -1.62207, 0.120117, 0.346436, 
self attn k(head): : -2.46484, 1.27539, 0.948242, 0.347168, 0.722656, 
self attn k(tail): : -1.26953, 0.32959, -1.09961, -2.59375, -0.157715, 
self attn v(head): : 0.488281, -0.602051, 0.641602, 1.25586, 0.183838, 
self attn v(tail): : -0.848145, -0.176025, -0.098877, -0.970703, -0.835449, 
self attn corr(head): : 0.0410767, 0.958984, 0.924316, 0.0755615, 0.981445, 
self attn corr(tail): : 0.393799, 0.959961, 0.0402527, 0.614746, 0.385254, 
self attn before ffn(head): : 0.491699, -0.573242, 0.625, 1.20215, 0.156616, 
self attn before ffn(tail): : -0.0899048, -0.854492, -0.430908, -0.471191, -0.238647, 
self attn out(head): : -0.25, 1.21387, -0.767578, 
self attn out(tail): : 5.5625, 10.7969, 12.3516, 
encdec attn ln(head): : -0.0619507, 0.0679321, -0.0736694, 0.0517883, -0.21875, 
encdec attn ln(tail): : -0.0151367, -0.123535, 0.153564, 0.170166, 0.225952, 
encdec attn ffn out(head): : -0.442871, -3.71094, -5.47266, 
encdec attn ffn out(tail): : 2.52344, 10.4375, 17.1562, 
ffn ln(head): : -0.101929, -0.289551, -0.821777, -0.214478, 2.0918, 
ffn ln(tail): : 0.0775757, 0.22522, 0.280762, 0.603516, 0.695312, 
ffn ln(head): : -3.70312, -3.08984, -5.91406, -1.80469, -200.75, 
ffn ln(tail): : -1.69141, -9.48438, 1.39648, 10.8125, 15.7578, 
self attn ln(head): : -0.123657, -0.0794678, -0.166138, -0.0440369, -0.153076, 
self attn ln(tail): : -0.0564575, -0.208374, 0.0604858, 0.16394, 0.2146, 
self qkv(head): : -0.234131, 1.09961, 0.00732422, 0.47998, -0.580566, 
self qkv(tail): : 0.400391, -0.754883, -0.328613, 0.553711, 0.655273, 
self attn q(head): : -0.2854, 0.867676, -0.0856323, 0.706543, -0.781738, 
self attn q(tail): : -0.117737, 2.66211, -1.91992, -0.892578, 0.25, 
self attn k(head): : 1.93457, 3.68555, 1.49609, -0.100098, 3.41406, 
self attn k(tail): : 0.550781, -1.47949, -1.98633, -4.85156, -1.875, 
self attn v(head): : 0.335938, 0.447266, 1.1084, -1.11719, 0.439941, 
self attn v(tail): : 0.455322, -1.11816, -0.248535, 0.93457, 0.482666, 
self attn corr(head): : 0.976562, 0.0234222, 0.0384521, 0.961426, 0.987793, 
self attn corr(tail): : 0.423828, 0.911621, 0.0883179, 0.989258, 0.0109253, 
self attn before ffn(head): : 0.0792847, -0.22876, 0.529297, -0.753906, -0.0793457, 
self attn before ffn(tail): : 0.11615, -0.87793, 0.136353, 0.613281, -0.119446, 
self attn out(head): : -6.17969, -2.03516, -2.51367, 
self attn out(tail): : 4.40625, 10.6484, 13.3828, 
encdec attn ln(head): : -0.0715332, 0.000144482, -0.0440369, -0.0283508, -0.176758, 
encdec attn ln(tail): : -0.0579224, -0.0800781, 0.0365295, 0.0439148, 0.0810547, 
encdec attn ffn out(head): : -7.53516, -14.9844, -16.4062, 
encdec attn ffn out(tail): : -16.0312, 11.1016, 7.75391, 
ffn ln(head): : -0.348633, -0.773438, -0.899902, -0.041748, 0.771484, 
ffn ln(tail): : -0.177612, -0.0638428, -0.303955, 0.566895, 0.217041, 
ffn ln(head): : -1.17969, -10.8906, -0.539062, -9.33594, -449.5, 
ffn ln(tail): : -1.0625, -11.2344, -16.3281, 0.257812, 6.82031, 
self attn ln(head): : -0.0939941, -0.166138, 0.0123367, -0.0701294, 0.308594, 
self attn ln(tail): : -0.0720825, -0.146484, -0.104919, -0.0292664, 0.00497055, 
self qkv(head): : 1.40625, -1.50684, -1.56934, 1.45605, 1.29004, 
self qkv(tail): : 2.10352, 0.258545, -1.74316, 1.57324, -0.983887, 
self attn q(head): : 1.51465, -1.50879, -1.2334, 1.46289, 0.976562, 
self attn q(tail): : -0.11731, -1.26562, -0.404297, 0.107422, 0.851074, 
self attn k(head): : 2.00391, -8.71875, 26.4062, 12.4688, -22.8438, 
self attn k(tail): : -1.83984, -0.488037, -0.681641, 0.124817, -0.197266, 
self attn v(head): : -0.0866699, 0.284668, -2.0293, 0.836914, 2.33398, 
self attn v(tail): : 2.12891, 0.252197, -1.82227, 1.91797, -0.98584, 
self attn corr(head): : 0.334473, 0.665527, 0.417969, 0.582031, 0.258301, 
self attn corr(tail): : 0.667969, 0.749023, 0.250977, 0.93457, 0.0656738, 
self attn before ffn(head): : 0.0533752, 0.138794, -1.64844, 0.822754, 1.77734, 
self attn before ffn(tail): : 0.972656, 0.532227, -0.994141, 0.405273, -0.713867, 
self attn out(head): : -1.91504, -6.30469, 2.49023, 
self attn out(tail): : -13.1953, 7.13672, 10.8438, 
encdec attn ln(head): : -0.00517654, -0.0133896, -0.0029335, -0.0157928, 0.0458069, 
encdec attn ln(tail): : -0.0515137, -0.105591, -0.0367737, -0.00547028, 0.00341606, 
encdec attn ffn out(head): : 2.27344, -6.55859, 13.625, 
encdec attn ffn out(tail): : -11.1016, 10.9453, -1.57031, 
ffn ln(head): : -0.0394897, -0.283691, -0.0739136, 0.0486145, -5.04688, 
ffn ln(tail): : 0.381836, -0.147461, -0.153687, 0.104492, 0.136841, 
ffn ln(head): : 6.16797, -9.85938, 3.24219, -1.14844, -611, 
ffn ln(tail): : 11.6875, -27.4062, -0.0859375, 1.26562, -10.6641, 
decoder output: batch-0, beam-0
hidden: 0.247314, -0.331543, -0.0403748, 0.188843, 4.24609, -0.36084, -0.961914, -0.259766, -0.0464478, -0.472412, 
logits: -50.75, -52.6562, -51.5625, -48.4375, -51, -51, -51.9062, -50.7188, -50.7188, -56.8438, 
ker_topk_sample_launcher with _cur_step=1  _max_step=64  _max_thread_per_block=256
### in ker_topk_sample_launcher 
### out ker_topk_sample_launcher 
unfinished flag: 1, 
Batch token ids: : 5001, 4, 6, 
*** run step 2 ***
decoder emb: batch-0, beam-0
emb: 0.836914, 0.681152, 0.458984, 1.13281, -19.2344, 1.67969, 1.4707, 1.78711, 1.99219, 2.05078, 
self attn ln(head): : 0.278564, 0.196167, 0.0700684, 0.297607, -0.0559082, 
self attn ln(tail): : -0.0521851, 0.168579, -0.222046, 0.230591, -0.201294, 
self qkv(head): : -0.185181, 2.6582, -1.25391, 1.19727, -0.683105, 
self qkv(tail): : 0.388428, -0.365967, -0.205078, 1.40918, 0.528809, 
self attn q(head): : -0.0535889, 2.59375, -1.48926, 1.11719, -0.759766, 
self attn q(tail): : 0.249268, -1.04492, 1.70312, 0.282715, -1.43945, 
self attn k(head): : 2.32031, -0.757812, 1.08887, -0.56543, -3.37891, 
self attn k(tail): : -3.77734, -1.64062, -7.97656, 0.660156, -4.25, 
self attn v(head): : 0.269531, -1.00488, 1.01855, 1.87891, -0.248779, 
self attn v(tail): : 0.311279, -0.414795, -0.108704, 1.39453, 0.724609, 
self attn corr(head): : 0.557129, 0.438721, 0.00429535, 0.908691, 0.0594177, 
self attn corr(tail): : 0.0736084, 0.00139046, 0.95459, 0.0439453, 0.00167751, 
self attn before ffn(head): : 0.202637, 0.651855, 0.133179, -0.182739, -0.221313, 
self attn before ffn(tail): : 0.0118484, -0.0822144, 0.118042, 0.0876465, 0.0970459, 
self attn out(head): : 1.39941, 1.10254, 1.05762, 
self attn out(tail): : -2.25, 8.44531, -2.14062, 
encdec attn ln(head): : 0.13623, 0.11554, 0.0419006, 0.144653, -0.556641, 
encdec attn ln(tail): : 0.015686, 0.055542, -0.0375061, 0.189819, -0.138916, 
encdec attn ffn out(head): : 1.28027, 1.26465, 0.601562, 
encdec attn ffn out(tail): : -1.18359, 11.5391, 3.92773, 
ffn ln(head): : 0.305908, 0.108765, -0.215942, 0.177124, 0.878906, 
ffn ln(tail): : -0.144287, -0.310547, 0.306152, 0.329346, -0.0446777, 
ffn ln(head): : 5.30859, 4.66406, 1.71094, 1.59277, -96.6875, 
ffn ln(tail): : -8.14062, -0.958008, 2.4668, 12.5859, 0.972656, 
self attn ln(head): : 0.304199, 0.25708, 0.0558777, 0.0756836, -0.350342, 
self attn ln(tail): : -0.134888, -0.0588989, 0.0788574, 0.250977, -0.0300598, 
self qkv(head): : 1.39258, 0.408936, 0.29541, 0.885254, 0.910645, 
self qkv(tail): : -0.136475, -0.72168, -1.23926, 0.304688, 0.438721, 
self attn q(head): : 1.45996, 0.374023, 0.446777, 0.953613, 1.01172, 
self attn q(tail): : -0.145996, -2.04883, -1.41016, 0.908203, 0.729492, 
self attn k(head): : -2.58203, 0.717773, 2.00195, -0.517578, 0.740234, 
self attn k(tail): : 0.473633, -0.0229492, -0.435059, -1.89258, 2.19141, 
self attn v(head): : 0.13916, -0.726074, 0.812012, 1.33105, 0.154541, 
self attn v(tail): : -0.0354004, -1.16309, -1.32227, 0.223877, 0.308105, 
self attn corr(head): : 0.106506, 0.865723, 0.0279083, 0.348389, 0.53125, 
self attn corr(tail): : 0.0484314, 0.0377197, 0.279297, 0.617188, 0.103821, 
self attn before ffn(head): : 0.487305, -0.530273, 0.603516, 1.11914, 0.112366, 
self attn before ffn(tail): : -0.419434, -0.586914, -0.376709, -0.620117, -0.445801, 
self attn out(head): : 12.4062, 4.86328, 4.57812, 
self attn out(tail): : 5.69531, 11.3906, 1.40137, 
encdec attn ln(head): : 0.185181, 0.162964, 0.0479126, 0.159546, -0.0837402, 
encdec attn ln(tail): : -0.0975342, -0.0222015, 0.153809, 0.175415, 0.005867, 
encdec attn ffn out(head): : 11.4922, 7.64062, 1.88086, 
encdec attn ffn out(tail): : -1.02734, 12.3438, 5.64844, 
ffn ln(head): : 0.491943, 0.274658, -0.393311, -0.130493, 2.14453, 
ffn ln(tail): : -0.169067, 0.174316, 0.144165, 0.706055, 0.198608, 
ffn ln(head): : 13.2109, 12.3906, 2.95703, 2.6875, -177.25, 
ffn ln(tail): : -11.3984, -9.21094, -2.99219, 17.3594, 4.5625, 
self attn ln(head): : 0.337158, 0.300049, 0.0422058, 0.0627441, -0.0619202, 
self attn ln(tail): : -0.188599, -0.206787, -0.00980377, 0.279053, 0.0426636, 
self qkv(head): : 0.148682, 1.18262, 1.10352, -0.265137, -0.370361, 
self qkv(tail): : 1.76758, -0.810547, 0.369141, 0.287598, 1.43359, 
self attn q(head): : 0.09729, 0.950684, 1.01074, -0.0384521, -0.571289, 
self attn q(tail): : 0.55127, 1.6084, -1.51074, 2.70312, -0.618164, 
self attn k(head): : 2.73047, 3.23047, 0.622559, 0.910645, 4.11328, 
self attn k(tail): : -0.762207, -1.3291, -0.591797, -5.16406, -0.334961, 
self attn v(head): : -2.6543, -0.210083, 1.45801, -1.51465, 0.1875, 
self attn v(tail): : 1.82227, -1.17383, 0.449219, 0.667969, 1.26074, 
self attn corr(head): : 0.619141, 0.187134, 0.193848, 0.115295, 0.592285, 
self attn corr(tail): : 0.0762329, 0.115784, 0.0509033, 0.639648, 0.309326, 
self attn before ffn(head): : -0.406494, -0.108704, 0.809082, -0.963867, 0.0618286, 
self attn before ffn(tail): : 0.86084, -1.12305, -0.0128632, 0.835449, 0.692383, 
self attn out(head): : 8.53125, 14.9609, 5.72656, 
self attn out(tail): : 1.44531, 19.8281, -0.078125, 
encdec attn ln(head): : 0.0668945, 0.143433, 0.0184631, 0.0595398, -0.123535, 
encdec attn ln(tail): : -0.109192, -0.0974121, 0.0166321, 0.0997314, -0.0176239, 
encdec attn ffn out(head): : 7.36719, 5.23438, -3.17578, 
encdec attn ffn out(tail): : -16.6562, 11.7266, -5.97656, 
ffn ln(head): : 0.130249, -0.103333, -0.415039, 0.431152, 0.80957, 
ffn ln(tail): : -0.262207, -0.085144, -0.299072, 0.576172, -0.173706, 
ffn ln(head): : 5.40625, 15.5391, 6.85938, 7.55859, -410.5, 
ffn ln(tail): : -18.9688, -4.74219, -9.14062, 7.93359, 8.39062, 
self attn ln(head): : 0.000938416, 0.129272, 0.0968628, 0.108765, 0.337402, 
self attn ln(tail): : -0.213623, -0.0931396, -0.0413818, 0.0404358, 0.0251007, 
self qkv(head): : 0.658203, -1.7168, -2.62891, 1.22559, -0.0877686, 
self qkv(tail): : 1.03711, 0.552734, -0.831543, 1.4834, -1.05762, 
self attn q(head): : 0.76709, -1.71875, -2.29297, 1.23242, -0.400879, 
self attn q(tail): : 0.479736, -0.867676, -0.94873, 0.234131, 0.0172119, 
self attn k(head): : 1.86621, -9.80469, 28.0156, 13.0234, -23.4688, 
self attn k(tail): : -1.99023, -0.356689, -0.970703, 0.643555, -0.799805, 
self attn v(head): : 0.711914, 0.470215, -1.32617, 1.67383, 1.56836, 
self attn v(tail): : 1.0625, 0.546387, -0.910645, 1.82812, -1.05957, 
self attn corr(head): : 0.186035, 0.525879, 0.288086, 0.233643, 0.356201, 
self attn corr(tail): : 0.312256, 0.133301, 0.553711, 0.192993, 0.253174, 
self attn before ffn(head): : 0.221313, 0.25708, -1.61426, 1.07031, 1.80371, 
self attn before ffn(tail): : 1.17285, 0.492432, -1.10059, 0.998535, -0.843262, 
self attn out(head): : 3.71289, 20.4062, 8.51562, 
self attn out(tail): : -4.64844, 13.4688, 11.4766, 
encdec attn ln(head): : 0.0311737, 0.124268, 0.0300903, 0.0709839, 0.0617065, 
encdec attn ln(tail): : -0.141968, -0.0822754, 0.000373125, 0.0228577, 0.00876617, 
encdec attn ffn out(head): : 8.875, 18.9844, 20.8438, 
encdec attn ffn out(tail): : -4.59375, 14.2656, -0.492188, 
ffn ln(head): : 0.0780029, 0.12262, 0.0698242, 0.314941, -4.98438, 
ffn ln(tail): : 0.0709229, -0.0758667, -0.0513916, 0.169556, 0.160645, 
ffn ln(head): : 24.125, 13.5859, 17.1719, 15.0391, -632.5, 
ffn ln(tail): : -9.76562, -26.1406, 5.49219, 0.46875, -5.0625, 
decoder output: batch-0, beam-0
hidden: 1.0293, 0.564453, 0.37207, 0.757812, 4.28125, -0.13147, -1.29004, -0.904297, 0.115601, -0.339111, 
logits: -44.6875, -45.625, -45.4375, -41.1562, -46.7188, -45.0625, -45.625, -44.6875, -44.6875, -51.3438, 
ker_topk_sample_launcher with _cur_step=2  _max_step=64  _max_thread_per_block=256
### in ker_topk_sample_launcher 
### out ker_topk_sample_launcher 
unfinished flag: 1, 
Batch token ids: : 5001, 4, 6, 4, 
*** run step 3 ***
decoder emb: batch-0, beam-0
emb: -0.354248, 0.468262, 0.930664, 0.125244, -22.0938, 1.11914, 2.08984, 0.554199, 2.91992, 1.06934, 
self attn ln(head): : -0.154419, 0.114197, 0.162842, 0.0174103, -0.0776367, 
self attn ln(tail): : 0.172974, -0.322754, 0.162842, 0.163696, 0.0222473, 
self qkv(head): : 2.44922, 0.95752, -1.2627, 0.30835, -3.37305, 
self qkv(tail): : 1.52344, 0.589844, 0.216919, 0.151855, 0.342529, 
self attn q(head): : 2.58008, 0.89209, -1.49805, 0.228394, -3.44922, 
self attn q(tail): : 1.5957, 0.368896, -0.395508, 0.281738, -1.12305, 
self attn k(head): : -0.366211, 1.11328, 0.898438, -0.680664, -1.0293, 
self attn k(tail): : -2.05859, -4.32031, -6.72656, -1.1543, -5.77734, 
self attn v(head): : 0.241943, 1.77637, 0.211914, -0.423096, -0.562012, 
self attn v(tail): : 1.44629, 0.541016, 0.313232, 0.137207, 0.538086, 
self attn corr(head): : 0.899902, 0.00149059, 0.0726929, 0.0257568, 0.547852, 
self attn corr(tail): : 0.000330925, 0.996582, 3.77893e-05, 0.00245094, 0.00110435, 
self attn before ffn(head): : 0.133057, -0.204834, 0.196167, 0.0586548, 0.0335693, 
self attn before ffn(tail): : -0.0318909, -0.0806885, 0.107178, 0.107483, 0.0719604, 
self attn out(head): : -0.105469, 0.402344, 2.05078, 
self attn out(tail): : -0.630859, 4.32031, 1.2168, 
encdec attn ln(head): : -0.0205383, 0.033844, 0.108704, 0.0186005, -0.551758, 
encdec attn ln(tail): : 0.157471, -0.270996, 0.0152664, 0.0392151, -0.0228882, 
encdec attn ffn out(head): : -0.133301, 0.827148, 1.80078, 
encdec attn ffn out(tail): : -1.52148, 7.90234, 9.55469, 
ffn ln(head): : -0.0789795, -0.00406647, -0.0362854, -0.282227, 0.797363, 
ffn ln(tail): : 0.164795, -0.69873, 0.292236, 0.155273, 0.244141, 
ffn ln(head): : 1.58398, 3.04297, 3.35938, 2.03906, -106.438, 
ffn ln(tail): : -1.72754, -10.4688, -0.563965, 12.2969, 10.7734, 
self attn ln(head): : 0.09552, 0.154663, 0.129517, 0.0883179, -0.406982, 
self attn ln(tail): : -0.0162659, -0.287109, 0.0108109, 0.229858, 0.189087, 
self qkv(head): : -0.844727, -0.201538, 0.49585, 0.397949, 0.145996, 
self qkv(tail): : -0.696289, -0.990234, 0.0802002, -0.53418, -0.443115, 
self attn q(head): : -0.777344, -0.236328, 0.647461, 0.466309, 0.247314, 
self attn q(tail): : -0.26709, -0.707031, -0.428223, -0.0175781, -0.052002, 
self attn k(head): : -1.79297, 0.955078, -0.0644531, -0.528809, 0.943359, 
self attn k(tail): : 0.105713, 1.38672, -1.09375, -3.2207, 1.27246, 
self attn v(head): : 0.582031, -0.377197, 0.289062, 1.24902, 0.482666, 
self attn v(tail): : -0.595215, -1.43164, -0.00323486, -0.615234, -0.57373, 
self attn corr(head): : 0.152344, 0.253662, 0.195923, 0.398193, 0.27002, 
self attn corr(tail): : 0.0812378, 0.157471, 0.0385132, 0.657227, 0.146606, 
self attn before ffn(head): : 0.469727, -0.428955, 0.473389, 1.06836, 0.195923, 
self attn before ffn(tail): : -0.0825195, -1.18262, -0.974121, -0.00537491, 0.107544, 
self attn out(head): : 5.75781, 2.82812, 6.46094, 
self attn out(tail): : 0.849609, 12.5781, 8.51562, 
encdec attn ln(head): : 0.0484924, 0.103333, 0.0800781, 0.216919, -0.112549, 
encdec attn ln(tail): : -0.00453568, -0.205933, 0.049469, 0.184937, 0.133789, 
encdec attn ffn out(head): : 5.65234, -0.664062, 3.17383, 
encdec attn ffn out(tail): : -5.78516, 12.375, 14.3594, 
ffn ln(head): : 0.178101, -0.141235, -0.338623, 0.288818, 2.18555, 
ffn ln(tail): : 0.0469666, -0.0775146, -0.0368347, 0.661621, 0.538086, 
ffn ln(head): : 2.86914, -2.74609, 6.07031, 8.30469, -190.875, 
ffn ln(tail): : -3.34961, -15.3359, -8.44531, 12.5625, 15.7344, 
self attn ln(head): : 0.0486755, -0.0712891, 0.107849, 0.185913, -0.0882568, 
self attn ln(tail): : -0.0783691, -0.295898, -0.0939941, 0.187378, 0.208008, 
self qkv(head): : 0.428955, 0.63916, -0.149048, 0.133911, -1.32129, 
self qkv(tail): : 1.18359, 0.0927124, 1.0332, 0.767578, 1.06348, 
self attn q(head): : 0.377686, 0.407227, -0.241943, 0.360596, -1.52246, 
self attn q(tail): : -0.473633, 2.60938, -1.3916, 0.842285, 0.694824, 
self attn k(head): : 2.1875, 3.50781, 1.37695, 0.38916, 4.10938, 
self attn k(tail): : -0.790039, -1.0498, 0.03125, -4.1875, -0.428955, 
self attn v(head): : 0.0134888, -0.0697021, 1.08496, -0.576172, 0.16333, 
self attn v(tail): : 1.23828, -0.270752, 1.11328, 1.14844, 0.890625, 
self attn corr(head): : 0.625488, 0.0737915, 0.223999, 0.0767212, 0.142212, 
self attn corr(tail): : 0.109253, 0.064209, 0.00324821, 0.723633, 0.208984, 
self attn before ffn(head): : -0.522949, -0.172607, 0.813965, -0.932129, 0.0295715, 
self attn before ffn(tail): : 1.58594, -0.96582, 0.565918, 0.765625, 1.0918, 
self attn out(head): : -2.48242, -0.853516, 8.92188, 
self attn out(tail): : -3.34766, 18.9688, 11.5, 
encdec attn ln(head): : -0.0321655, 0.0120316, 0.038208, 0.0820312, -0.137817, 
encdec attn ln(tail): : -0.0617981, -0.118958, -0.0129776, 0.0880737, 0.057312, 
encdec attn ffn out(head): : -1.58008, -14.5781, -3.25781, 
encdec attn ffn out(tail): : -29.8281, 19.1094, 5.78516, 
ffn ln(head): : -0.147705, -0.717773, -0.414551, 0.38916, 0.799805, 
ffn ln(tail): : -0.139404, -0.194458, -0.61377, 0.766113, 0.149414, 
ffn ln(head): : -6.28906, -9.14844, 4.375, 7.84375, -458.5, 
ffn ln(tail): : -10.1641, -12.9453, -31.9531, 19.6719, 13.3516, 
self attn ln(head): : -0.158813, -0.143677, 0.0654297, 0.105652, 0.308838, 
self attn ln(tail): : -0.137451, -0.157227, -0.243896, 0.131958, 0.0633545, 
self qkv(head): : 0.95459, -1.39453, -1.03516, 1.37695, 1.42285, 
self qkv(tail): : 0.774902, 0.217529, -0.220825, 0.713379, -0.428223, 
self attn q(head): : 1.06348, -1.39648, -0.699219, 1.38379, 1.10938, 
self attn q(tail): : 0.686523, -0.978027, -1.0459, -0.00463867, 0.472412, 
self attn k(head): : 1.51172, -8.6875, 27.125, 12.3203, -24.3906, 
self attn k(tail): : -0.637207, -1.22852, -0.771484, 1.26465, -0.338867, 
self attn v(head): : -0.211182, 0.100037, -0.602051, 0.0258789, 1.44727, 
self attn v(tail): : 0.800781, 0.211304, -0.299805, 1.05762, -0.429932, 
self attn corr(head): : 0.236206, 0.395508, 0.239868, 0.128418, 0.175171, 
self attn corr(tail): : 0.253662, 0.247559, 0.129639, 0.181396, 0.441406, 
self attn before ffn(head): : 0.187744, 0.202515, -1.4082, 0.92334, 1.64355, 
self attn before ffn(tail): : 1.04297, 0.361572, -0.765137, 1.12109, -0.681641, 
self attn out(head): : -7.91016, -4.48047, 5.66016, 
self attn out(tail): : -28.4219, 25.8906, 17.0469, 
encdec attn ln(head): : -0.0394897, -0.00287056, 0.0130844, 0.0680542, 0.0341797, 
encdec attn ln(tail): : -0.0970459, -0.105103, -0.0990601, 0.0674438, 0.0281067, 
encdec attn ffn out(head): : -4.29688, -2.42969, 16.1562, 
encdec attn ffn out(tail): : -25.7656, 29.8281, 5.48438, 
ffn ln(head): : -0.143555, -0.217163, -0.0323181, 0.257568, -5.10547, 
ffn ln(tail): : 0.213135, -0.071167, -0.376465, 0.397949, 0.278809, 
ffn ln(head): : 14.4766, 1.49609, 15.3359, 9.36719, -710.5, 
ffn ln(tail): : -5.64453, -25.8438, -22.0156, 22.3438, -0.386719, 
decoder output: batch-0, beam-0
hidden: 0.560059, 0.0978394, 0.285156, 0.533691, 4.4375, -0.0903931, -1.17578, -0.441162, -0.19043, -0.339844, 
logits: -39.3438, -39.5, -41.5, -37.875, -41.0312, -38.875, -40.125, -39.3438, -39.3438, -45.125, 
ker_topk_sample_launcher with _cur_step=3  _max_step=64  _max_thread_per_block=256
### in ker_topk_sample_launcher 
### out ker_topk_sample_launcher 
unfinished flag: 1, 
Batch token ids: : 5001, 4, 6, 4, 5, 
one infer time duration time is: 40.1952 ms
Transformer output shape: 1 1 5 
Transformer output shape: 1 1 
(base) ]0;poweruser@s-113-1-1: ~/junda.feng/ixinfer/TransformerInfer/build[01;32mpoweruser@s-113-1-1[00m:[01;34m~/junda.feng/ixinfer/TransformerInfer/build[00m$ ./TransfomrerInfer ../model_weights/transformer.pb 1 1[Kexit
exit

Script done on 2022-10-12 22:23:39+0800
